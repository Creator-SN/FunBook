(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-40b851e8"],{"07de":function(t,e,a){"use strict";a("5af3")},3524:function(t,e,a){"use strict";a("7879")},4260:function(t,e,a){"use strict";a("439b")},"439b":function(t,e,a){},"504f":function(t,e,a){"use strict";a("5972")},5972:function(t,e,a){},"5af3":function(t,e,a){},"66b3":function(t,e,a){t.exports=a.p+"img/empty_emo.4154b04d.svg"},"6b01":function(t,e,a){"use strict";a("d638")},7879:function(t,e,a){},"7abe":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"ikfb-home-container",class:[{dark:"dark"===t.theme}]},[e("div",{staticClass:"s-row"},[e("p",{staticClass:"s-title"},[t._v(t._s(!1===t.pid?t.local("All"):t.pname))])]),e("div",{staticClass:"m-home-block"},[e("div",{staticClass:"row between"},[e("fv-text-box",{staticStyle:{"box-shadow":"0px 3px 8px rgba(0, 0, 0, 0.1)"},attrs:{placeholder:t.local("Filtering from current content"),theme:t.theme,background:"dark"===t.theme?"rgba(75, 75, 75, 1)":"rgba(245, 245, 245, 1)",icon:"Filter",borderWidth:"2",revealBorder:!0},model:{value:t.currentSearch,callback:function(e){t.currentSearch=e},expression:"currentSearch"}}),e("div",{staticClass:"sort-block"},[e("fv-combobox",{staticStyle:{width:"120px"},attrs:{options:t.sortOptions,placeholder:t.local("Sort by"),inputBackground:"dark"===t.theme?"rgba(75, 75, 75, 1)":"rgba(245, 245, 245, 1)",borderRadius:3,theme:t.theme},model:{value:t.sortKey,callback:function(e){t.sortKey=e},expression:"sortKey"}}),e("fv-button",{staticStyle:{width:"35px",height:"35px","margin-left":"5px"},attrs:{theme:t.theme,disabled:void 0==t.sortKey.key,title:1==t.sortDesc?t.local("Switch to Descending"):t.local("Switch to Ascending")},on:{click:function(e){t.sortDesc=-t.sortDesc}}},[e("i",{staticClass:"ms-Icon",class:["ms-Icon--"+(1==t.sortDesc?"Ascending":"Descending")],staticStyle:{"font-size":"18px"}})])],1)],1),e("div",{staticClass:"row command-bar"},[e("fv-command-bar",{staticStyle:{flex:"1"},attrs:{options:t.cmd,theme:t.theme,background:"dark"===t.theme?"transparent":"rgba(245, 245, 245, 1)"}})],1),e("div",{staticClass:"row main-table"},[e("main-list",{attrs:{value:t.filterItems,edit:t.editable,sortKey:t.sortKey.key,desc:t.sortDesc,theme:t.theme,filter:t.currentSearch},on:{"open-file":t.openFile,"label-click":e=>{t.currentItem=e,t.show.rename=!0},rightclick:function(e){t.currentItem=e},"choose-items":function(e){t.currentChoosen=e},"insert-emoji":function(e){return t.reviseItemEmoji(e.item,e.emoji)}},scopedSlots:t._u([{key:"row_expand",fn:function(a){return[e("div",{staticClass:"main-row-item-info"},[e("div",{staticClass:"item",staticStyle:{display:"flex"},on:{click:e=>{t.currentItem=a.item,t.show.rename=!0}}},[a.item.labels.length>0?e("fv-tag",{staticStyle:{width:"100%"},attrs:{value:a.item.labels,theme:t.theme}}):t._e(),a.item.labels.length<=0?e("i",{staticClass:"ms-Icon ms-Icon--Tag"}):t._e(),a.item.labels.length<=0?e("p",{staticStyle:{"margin-left":"15px"}},[t._v(t._s(t.local("Add Labels"))+" ")]):t._e()],1),e("div",{directives:[{name:"show",rawName:"v-show",value:a.item.pdf,expression:"x.item.pdf"}],staticClass:"item",on:{dblclick:function(e){return t.openFile(`${a.item.id}/${a.item.pdf}.pdf`)}}},[e("i",{staticClass:"ms-Icon ms-Icon--PDF"}),e("p",{staticClass:"highlight",on:{click:function(e){return t.openFile(`${a.item.id}/${a.item.pdf}.pdf`)}}},[t._v("PDF")]),e("p",{staticClass:"sec highlight",on:{click:function(e){return t.openFile(`${a.item.id}/${a.item.pdf}.pdf`)}}},[t._v(" "+t._s(a.item.pdf)+".pdf")]),e("p"),e("fv-button",{staticStyle:{width:"35px",height:"35px"},attrs:{background:"rgba(255, 180, 0, 1)",title:t.local("Open Folder")},on:{click:function(e){return t.openFile(""+a.item.id)}}},[e("i",{staticClass:"ms-Icon ms-Icon--FabricFolder"})])],1),e("div",{directives:[{name:"show",rawName:"v-show",value:a.item.metadata,expression:"x.item.metadata"}],staticClass:"item"},[e("i",{staticClass:"ms-Icon ms-Icon--LinkedDatabase"}),e("p",{staticClass:"highlight",on:{click:function(e){return t.showMetadata(a.item)}}},[t._v("Metadata")]),e("p",{staticClass:"sec highlight",on:{click:function(e){return t.showMetadata(a.item)}}},[t._v(t._s(a.item.id)+".metadata")]),e("p"),e("fv-button",{staticStyle:{width:"35px",height:"35px"},attrs:{background:"rgba(255, 180, 0, 1)",title:t.local("Open Folder")},on:{click:function(e){return t.openFile(""+a.item.id)}}},[e("i",{staticClass:"ms-Icon ms-Icon--FabricFolder"})])],1),t._l(a.item.pages,(function(i,s){return e("div",{key:s,staticClass:"item"},[e("emoji-callout",{staticStyle:{width:"25px"},attrs:{value:i.emoji,theme:t.theme},on:{"insert-emoji":function(e){return t.revisePageEmoji(a.item,i,e)}}}),e("p",{staticClass:"highlight",on:{click:function(e){return t.openEditor(a.item,i)}}},[t._v(t._s(i.name))]),e("p",{staticClass:"sec"},[t._v(t._s(i.id))]),e("p",{staticClass:"sec"},[t._v(t._s(i.createDate))]),e("fv-button",{staticStyle:{width:"35px",height:"35px"},attrs:{theme:"dark",background:"rgba(0, 120, 212, 1)",title:t.local("Rename")},on:{click:function(e){return t.showRenameItemPage(a.item,i)}}},[e("i",{staticClass:"ms-Icon ms-Icon--Rename"})]),e("fv-button",{staticStyle:{width:"35px",height:"35px"},attrs:{theme:"dark",background:"rgba(220, 62, 72, 1)",title:t.local("Delete")},on:{click:function(e){return t.deleteItemPage(a.item.id,i.id)}}},[e("i",{staticClass:"ms-Icon ms-Icon--Delete"})])],1)})),e("div",{staticClass:"item",staticStyle:{display:"flex"},on:{click:e=>{t.currentItem=a.item,t.show.addItemPage=!0}}},[e("i",{staticClass:"ms-Icon ms-Icon--Add"}),e("p",{staticStyle:{"margin-left":"15px"}},[t._v(t._s(t.local("Add Page")))])])],2)]}},{key:"menu",fn:function(){return[e("div",[e("span",{on:{click:function(e){t.show.addItemPage=!0}}},[e("i",{staticClass:"ms-Icon ms-Icon--PageAdd",staticStyle:{color:"rgba(38, 188, 140, 1)"}}),e("p",[t._v(t._s(t.local("Add Page")))])]),e("span",{on:{click:t.reviseItemPdf}},[e("i",{staticClass:"ms-Icon ms-Icon--PDF",staticStyle:{color:"rgba(220, 62, 72, 1)"}}),e("p",[t._v(t._s(t.local("Revise PDF")))])]),e("span",{on:{click:function(e){t.show.metadata=!0}}},[e("i",{staticClass:"ms-Icon ms-Icon--LinkedDatabase",staticStyle:{color:"rgba(229, 173, 70, 1)"}}),e("p",[t._v(t._s(t.local("Revise Metadata")))])]),e("span",{on:{click:function(e){return t.openFile(""+t.currentItem.id)}}},[e("i",{staticClass:"ms-Icon ms-Icon--FabricFolder",staticStyle:{color:"rgba(229, 173, 70, 1)"}}),e("p",[t._v(t._s(t.local("Open Folder")))])]),e("hr"),e("span",{on:{click:function(e){t.show.folder=!0}}},[e("i",{staticClass:"ms-Icon ms-Icon--FabricMovetoFolder",staticStyle:{color:"rgba(0, 90, 158, 1)"}}),e("p",[t._v(t._s(t.local("Copy to Partitions")))])]),e("span",{on:{click:function(e){t.show.rename=!0}}},[e("i",{staticClass:"ms-Icon ms-Icon--Rename",staticStyle:{color:"rgba(0, 90, 158, 1)"}}),e("p",[t._v(t._s(t.local("Rename Item")))])]),e("span",{directives:[{name:"show",rawName:"v-show",value:!1!==t.pid,expression:"pid !== false"}],on:{click:t.deleteItemsFromPartition}},[e("i",{staticClass:"ms-Icon ms-Icon--RemoveFrom",staticStyle:{color:"rgba(220, 62, 72, 1)"}}),e("p",[t._v(t._s(t.local("Remove From Partition")))])]),e("span",{directives:[{name:"show",rawName:"v-show",value:!1===t.pid,expression:"pid === false"}],on:{click:t.deleteItem}},[e("i",{staticClass:"ms-Icon ms-Icon--Delete",staticStyle:{color:"rgba(220, 62, 72, 1)"}}),e("p",[t._v(t._s(t.local("Delete Item")))])])])]},proxy:!0}])}),0===t.filterItems.length?e("item-list-empty"):t._e()],1)]),e("add-item",{attrs:{show:t.show.add},on:{"update:show":function(e){return t.$set(t.show,"add",e)}}}),e("rename-item",{attrs:{value:t.currentItem,show:t.show.rename},on:{"update:show":function(e){return t.$set(t.show,"rename",e)}}}),e("add-item-page",{attrs:{show:t.show.addItemPage,item:t.currentItem},on:{"update:show":function(e){return t.$set(t.show,"addItemPage",e)}}}),e("rename-item-page",{attrs:{value:t.currentItemPage,show:t.show.renameItemPage,item:t.currentItem},on:{"update:show":function(e){return t.$set(t.show,"renameItemPage",e)}}}),e("metadata-panel",{attrs:{item:t.currentItem},model:{value:t.show.metadata,callback:function(e){t.$set(t.show,"metadata",e)},expression:"show.metadata"}}),e("folder-window",{on:{"choose-partitions":t.copyItemsToPartitions},model:{value:t.show.folder,callback:function(e){t.$set(t.show,"folder",e)},expression:"show.folder"}})],1)},s=[],o=function(){var t=this,e=t._self._c;return e("float-window-base",{attrs:{title:t.local("Add Item"),theme:t.theme},scopedSlots:t._u([{key:"content",fn:function(){return[e("div",{staticClass:"w-p-block"},[e("p",{staticClass:"w-title"},[t._v(t._s(t.local("Item Name")))]),e("fv-text-box",{staticStyle:{width:"100%",height:"60px","margin-top":"15px"},attrs:{placeholder:t.local("Input item name..."),theme:t.theme,"font-size":18,"font-weight":"bold",underline:"","focus-border-color":"rgba(123, 139, 209, 1)","is-box-shadow":!0},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.add.apply(null,arguments)}},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1),e("div",{staticClass:"w-p-block"},[e("p",{staticClass:"w-title"},[t._v(t._s(t.local("Item Labels")))])]),e("div",{staticClass:"w-p-row"},t._l(t.colorList,(function(a,i){return e("fv-check-box",{key:i,attrs:{"border-color":a.color,background:a.color},on:{click:function(e){return t.chooseColor(i)}},model:{value:a.check,callback:function(e){t.$set(a,"check",e)},expression:"item.check"}})})),1),e("div",{staticClass:"w-p-block"},[e("fv-text-box",{attrs:{placeholder:t.local("New item label (Press Enter)"),icon:"Tag",theme:t.theme,"border-color":t.currentColor},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addLabel.apply(null,arguments)}},model:{value:t.label,callback:function(e){t.label=e},expression:"label"}})],1),e("div",{staticClass:"w-p-block",staticStyle:{"overflow-x":"auto"}},[e("fv-tag",{attrs:{theme:t.theme,isDel:!0},model:{value:t.labels,callback:function(e){t.labels=e},expression:"labels"}})],1)]},proxy:!0},{key:"control",fn:function(){return[e("fv-button",{attrs:{theme:"dark",background:"rgba(0, 153, 204, 1)",disabled:""===t.name||!t.cur_db},on:{click:t.add}},[t._v(" "+t._s(t.local("Confirm")))]),e("fv-button",{attrs:{theme:t.theme},on:{click:function(e){t.thisShow=!1}}},[t._v(t._s(t.local("Cancel")))])]},proxy:!0}]),model:{value:t.thisShow,callback:function(e){t.thisShow=e},expression:"thisShow"}})},l=[],r=a("4c9f"),n=a("bb93"),c=a("bcbe"),h=a("d048"),d={components:{floatWindowBase:r["a"]},props:{show:{default:!1}},data(){return{thisShow:this.show,name:"",label:"",labels:[],colorList:[{name:"purple",color:"#958DF1",check:!1},{name:"red",color:"#F98181",check:!1},{name:"orange",color:"#FBBC88",check:!1},{name:"yellow",color:"#FAF594",check:!1},{name:"blue",color:"#70CFF8",check:!1},{name:"teal",color:"#94FADB",check:!1},{name:"green",color:"#B9F18D",check:!1},{name:"red",color:"#ffa8a8",check:!1},{name:"orange",color:"#ffc078",check:!1},{name:"green",color:"#8ce99a",check:!1},{name:"blue",color:"#74c0fc",check:!1},{name:"purple",color:"#b197fc",check:!1}]}},watch:{show(t){this.thisShow=t},thisShow(t){this.$emit("update:show",t),this.name="",this.labels=[]}},computed:{...Object(c["d"])({root:t=>t.root,data_index:t=>t.data_index,data_path:t=>t.data_path,items:t=>t.data_structure.items,groups:t=>t.data_structure.groups,partitions:t=>t.data_structure.partitions,c:t=>t.pdfImporter.c,theme:t=>t.theme}),...Object(c["b"])(["local","cur_db"]),v(){return this},currentColor(){for(let t of this.colorList)if(t.check)return t.color;return"rgba(25, 106, 167, 1)"}},methods:{...Object(c["c"])({reviseDS:"reviseDS",revisePdfImporter:"revisePdfImporter"}),async add(){if(!this.cur_db||""===this.name)return;let t=JSON.parse(JSON.stringify(n["d"]));t.id=this.$Guid(),t.name=this.name,t.emoji="📦",t.labels=this.labels,t.createDate=this.$SDate.DateToString(new Date),this.items.push(t),this.reviseDS({$index:this.data_index,items:this.items}),this.copyToPartition(t),await this.root.clone().path("root/items").createListAsync({name:t.id,conflict:h["ConflictBehavior"].Fail}),this.thisShow=!1},copyToPartition(t){let e=this.$route.params.id;if(void 0===e)return;let a=[].concat(this.groups),i=[];for(let s=0;s<a.length;s++)a[s].groups&&(a=a.concat(a[s].groups)),a[s].partitions&&(i=i.concat(a[s].partitions));i=i.concat(this.partitions);for(let s=0;s<i.length;s++)i[s].id===e&&i[s].items.push(t.id);this.reviseDS({$index:this.data_index,groups:this.groups,partitions:this.partitions})},addLabel(){""!==this.label&&(this.labels.push({text:this.label,background:this.currentColor}),this.label="")},chooseColor(t){this.colorList.forEach((e,a)=>{t!==a&&(e.check=!1,this.$set(this.colorList,a,e))})}}},u=d,m=a("8e3e"),p=Object(m["a"])(u,o,l,!1,null,null,null),f=p.exports,b=function(){var t=this,e=t._self._c;return e("float-window-base",{attrs:{title:t.local("Rename Item"),theme:t.theme},scopedSlots:t._u([{key:"content",fn:function(){return[e("div",{staticClass:"w-p-block"},[e("p",{staticClass:"w-title"},[t._v(t._s(t.local("Item Name")))]),e("fv-text-box",{staticStyle:{width:"100%",height:"60px","margin-top":"15px"},attrs:{placeholder:t.local("Input item name..."),theme:t.theme,"font-size":18,"font-weight":"bold",underline:"","focus-border-color":"rgba(123, 139, 209, 1)","is-box-shadow":!0},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.confirm.apply(null,arguments)}},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1),e("div",{staticClass:"w-p-block"},[e("p",{staticClass:"w-title"},[t._v(t._s(t.local("Item Labels")))])]),e("div",{staticClass:"w-p-row"},t._l(t.colorList,(function(a,i){return e("fv-check-box",{key:i,attrs:{"border-color":a.color,background:a.color},on:{click:function(e){return t.chooseColor(i)}},model:{value:a.check,callback:function(e){t.$set(a,"check",e)},expression:"item.check"}})})),1),e("div",{staticClass:"w-p-block"},[e("fv-text-box",{attrs:{placeholder:t.local("New item label (Press Enter)"),icon:"Tag",theme:t.theme,"border-color":t.currentColor},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addLabel.apply(null,arguments)}},model:{value:t.label,callback:function(e){t.label=e},expression:"label"}})],1),e("div",{staticClass:"w-p-block",staticStyle:{"overflow-x":"auto"}},[e("fv-tag",{attrs:{theme:t.theme,isDel:!0},model:{value:t.labels,callback:function(e){t.labels=e},expression:"labels"}})],1)]},proxy:!0},{key:"control",fn:function(){return[e("fv-button",{attrs:{theme:"dark",background:"rgba(0, 153, 204, 1)",disabled:!t.value||""===t.name||!t.cur_db},on:{click:t.confirm}},[t._v(t._s(t.local("Confirm")))]),e("fv-button",{attrs:{theme:t.theme},on:{click:function(e){t.thisShow=!1}}},[t._v(t._s(t.local("Cancel")))])]},proxy:!0}]),model:{value:t.thisShow,callback:function(e){t.thisShow=e},expression:"thisShow"}})},v=[],g={components:{floatWindowBase:r["a"]},props:{value:{default:null},show:{default:!1}},data(){return{thisShow:this.show,name:"",label:"",labels:[],colorList:[{name:"purple",color:"#958DF1",check:!1},{name:"red",color:"#F98181",check:!1},{name:"orange",color:"rgba(234, 152, 101, 1)",check:!1},{name:"yellow",color:"rgba(243, 228, 102, 1)",check:!1},{name:"blue",color:"#70CFF8",check:!1},{name:"teal",color:"rgba(103, 224, 192, 1)",check:!1},{name:"green",color:"#B9F18D",check:!1},{name:"red",color:"#ffa8a8",check:!1},{name:"orange",color:"#ffc078",check:!1},{name:"green",color:"#8ce99a",check:!1},{name:"blue",color:"#74c0fc",check:!1},{name:"purple",color:"#b197fc",check:!1}]}},watch:{show(t){this.thisShow=t},thisShow(t){this.$emit("update:show",t),this.value.name?this.name=this.value.name:this.name="",this.value.labels?this.labels=JSON.parse(JSON.stringify(this.value.labels)):this.labels=[]}},computed:{...Object(c["d"])({data_index:t=>t.data_index,data_path:t=>t.data_path,items:t=>t.data_structure.items,theme:t=>t.theme}),...Object(c["b"])(["local","cur_db"]),v(){return this},currentColor(){for(let t of this.colorList)if(t.check)return t.color;return"rgba(25, 106, 167, 1)"}},methods:{...Object(c["c"])({reviseDS:"reviseDS"}),async confirm(){if(!this.cur_db||!this.value||""===this.name)return;let t=this.items.find(t=>t.id===this.value.id);t.name=this.name,t.labels=this.labels,this.value.name=this.name,this.value.labels=this.labels,this.reviseDS({$index:this.data_index,items:this.items}),this.thisShow=!1},addLabel(){""!==this.label&&(this.labels.push({text:this.label,background:this.currentColor}),this.label="")},chooseColor(t){this.colorList.forEach((e,a)=>{t!==a&&(e.check=!1,this.$set(this.colorList,a,e))})}}},x=g,k=Object(m["a"])(x,b,v,!1,null,null,null),y=k.exports,w=function(){var t=this,e=t._self._c;return e("fv-infinite-scroll-view",{staticClass:"collapse-list-block",attrs:{value:t.visibleValue},on:{"init-start":function(e){t.loading=!0},"init-end":function(e){t.loading=!1}},scopedSlots:t._u([{key:"default",fn:function(a){return[t._l(a.dynamicValue,(function(a,i){return e("fv-collapse",{directives:[{name:"show",rawName:"v-show",value:a.show,expression:"item.show"}],key:i,staticStyle:{margin:"5px"},attrs:{theme:t.theme,title:a.name,content:`${t.local("Create Time")}: ${a.createDate}`,maxHeight:350},nativeOn:{contextmenu:function(e){return t.rightClick(e,a)}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("div",{directives:[{name:"show",rawName:"v-show",value:!t.edit,expression:"!edit"}],staticClass:"icon-block"},[e("p",{staticClass:"index"},[t._v(t._s(i+1))]),e("emoji-callout",{attrs:{value:a.emoji,theme:t.theme},on:{"insert-emoji":function(e){return t.$emit("insert-emoji",{item:a,emoji:e})}}})],1),e("div",{directives:[{name:"show",rawName:"v-show",value:t.edit,expression:"edit"}],staticClass:"icon-block"},[e("p",{staticClass:"index"},[t._v(t._s(i+1))]),e("fv-check-box",{attrs:{borderColor:"dark"==t.theme?"whitesmoke":""},on:{click:function(e){return t.itemChooseClick(a)}},model:{value:a.choosen,callback:function(e){t.$set(a,"choosen",e)},expression:"item.choosen"}})],1)]},proxy:!0},{key:"title",fn:function(i){return[e("div",{staticClass:"custom-collapse-title"},[e("p",{staticClass:"title-content h",on:{dblclick:function(e){a.pdf?t.$emit("open-file",`${a.id}/${a.pdf}.pdf`):t.$emit("open-file",""+a.id)}}},[t._v(t._s(i.title))])])]}},{key:"content",fn:function(i){return[e("div",{staticClass:"collapse-info",staticStyle:{display:"flex"}},[e("p",{staticStyle:{width:"180px"}},[t._v(t._s(i.content))]),a.metadata&&a.metadata.year?e("fv-button",{staticStyle:{width:"50px",height:"25px",margin:"0px 15px"},attrs:{theme:"dark",background:"rgba(0, 204, 153, 1)",fontSize:"12"}},[t._v(t._s(a.metadata.year))]):t._e()],1)]}},{key:"extension",fn:function(){return[e("fv-tag",{staticClass:"tag-block",staticStyle:{"max-width":"120px",overflow:"auto"},attrs:{value:a.labels,theme:t.theme},nativeOn:{click:function(e){return t.$emit("label-click",a)}}})]},proxy:!0}],null,!0)},[t._t("row_expand",null,{item:a})],2)})),t.loading?e("fv-shimmer",{staticStyle:{position:"relative",width:"100%",height:"auto"}},[t._l(2,(function(t,a){return e("div",{key:a,staticStyle:{"margin-top":"5px",display:"flex","align-items":"center"}},[e("div",{staticClass:"sample",staticStyle:{width:"30px",height:"30px",margin:"5px","border-radius":"50%"}}),e("div",{staticClass:"sample",staticStyle:{width:"80%",flex:"1",margin:"5px"}})])})),e("div",{staticStyle:{width:"100%",height:"100%",display:"flex","flex-direction":"column"}},t._l(1,(function(t,a){return e("div",{key:a,staticStyle:{"margin-top":"5px",display:"flex","align-items":"center"}},[e("div",{staticClass:"sample",staticStyle:{width:"80%",height:"15px",margin:"5px"},style:{width:100-10*a+"%"}})])})),0)],2):t._e(),e("right-menu",{attrs:{theme:t.theme,posX:t.posX,posY:t.posY,rightMenuWidth:t.rightMenuWidth},on:{"update-height":function(e){t.rightMenuHeight=e}},model:{value:t.show.rightMenu,callback:function(e){t.$set(t.show,"rightMenu",e)},expression:"show.rightMenu"}},[t._t("menu")],2)]}}],null,!0)})},_=[],C=a("0e93"),I=a("820f"),S={name:"mainList",components:{emojiCallout:C["a"],rightMenu:I["a"]},props:{value:{type:Array,default:()=>[]},filter:{default:()=>({key:"any",value:""})},edit:{default:!1},desc:{default:1},sortKey:{default:""},rightMenuWidth:{default:200},theme:{default:"light"}},data(){return{thisValue:this.value,posX:0,posY:0,rightMenuHeight:0,loading:!1,show:{rightMenu:!1}}},watch:{value(){this.thisValue=this.value,this.valueInit()},thisValue(){this.$emit("input",this.thisValue)},sortKey(){this.sort()},desc(){this.sort()},filter(){this.filterValue()},"filter.value"(){this.filterValue()}},computed:{...Object(c["b"])(["local"]),currentChoosen(){let t=[];for(let e=0;e<this.thisValue.length;e++)this.thisValue[e].choosen&&this.thisValue[e].show&&t.push(this.thisValue[e]);return t},currentChoosenAll(){for(let t=0;t<this.thisValue.length;t++)if(1!=this.thisValue[t].choosen&&this.thisValue[t].show)return!1;return!0},currentChoosenNum(){let t=0;for(let e=0;e<this.thisValue.length;e++)this.thisValue[e].choosen&&this.thisValue[e].show&&t++;return t},visibleValue(){let t=[];for(let e=0;e<this.thisValue.length;e++)this.thisValue[e].show&&t.push(this.thisValue[e]);return t}},mounted(){this.valueInit()},methods:{valueInit(){let t=JSON.parse(JSON.stringify(this.value));for(let e=0;e<t.length;e++)t[e].choosen=void 0!=t[e].choosen&&t[e].choosen,t[e].show=!0;this.thisValue=t,this.filterValue()},filterValue(){let t=this.filter;if("string"==typeof this.filter&&(t={key:"any",value:this.filter}),void 0==t.key||void 0==t.value)return console.warn(this.filter,"Invalid filter."),0;if("any"==t.key)for(let e=0;e<this.thisValue.length;e++){let a=!1,i=this.thisValue[e];for(let s in this.thisValue[e])if("string"==typeof i[s]&&i[s].toLowerCase().indexOf(t.value.toLowerCase())>-1){a=!0;break}i.show=a,this.$set(this.thisValue,e,i)}else for(let e=0;e<this.thisValue.length;e++){let a=this.thisValue[e],i=this.thisValue[e][this.filter.key].toLowerCase().indexOf(t.value.toLowerCase())>-1;a.show=i,this.$set(this.thisValue,e,a)}this.$emit("change-value",this.thisValue)},rightClick(t,e){t.preventDefault(),this.show.rightMenu=!0;let a=this.$el.getBoundingClientRect(),i={};i.x=t.x,i.y=t.y,i.x<a.left&&(i.x=a.left),i.x+this.rightMenuWidth>a.right&&(i.x=a.right-this.rightMenuWidth),i.y<a.top&&(i.y=a.top),i.y+this.rightMenuHeight>a.bottom&&(i.y=a.bottom-this.rightMenuHeight),this.posX=i.x,this.posY=i.y,this.$emit("rightclick",e)},itemChooseClick(t){let e=this.thisValue.indexOf(t),a=t;a.choosen=!a.choosen,this.$set(this.thisValue,e,a),this.$emit("change-value",this.thisValue),this.$emit("choose-items",this.currentChoosen)},sort(){let t=["year"],e=["name"],a=["title","publisher"],i=["createDate"];t.find(t=>t==this.sortKey)?this.thisValue.sort((t,e)=>t.metadata&&t.metadata[this.sortKey]?e.metadata&&e.metadata[this.sortKey]?this.desc*this.sortNum(t.metadata[this.sortKey],e.metadata[this.sortKey]):1*this.desc:-1*this.desc):e.find(t=>t==this.sortKey)?this.thisValue.sort((t,e)=>t[this.sortKey]?e[this.sortKey]?this.desc*this.sortName(t[this.sortKey],e[this.sortKey]):1*this.desc:-1*this.desc):a.find(t=>t==this.sortKey)?this.thisValue.sort((t,e)=>t.metadata&&t.metadata[this.sortKey]?e.metadata&&e.metadata[this.sortKey]?this.desc*this.sortName(t.metadata[this.sortKey],e.metadata[this.sortKey]):1*this.desc:-1*this.desc):i.find(t=>t==this.sortKey)&&this.thisValue.sort((t,e)=>t[this.sortKey]?e[this.sortKey]?this.desc*this.sortTime(t[this.sortKey],e[this.sortKey]):1*this.desc:-1*this.desc)},sortNum(t,e){return parseFloat(t)<parseFloat(e)?1:-1},sortName(t,e){return t?e?t.localeCompare(e):1:-1},sortTime(t,e){return this.$SDate.Compare(this.$SDate.Parse(t),this.$SDate.Parse(e))}}},$=S,O=(a("4260"),Object(m["a"])($,w,_,!1,null,null,null)),D=O.exports,P=function(){var t=this,e=t._self._c;return e("div",{staticClass:"item-list-empty-container",class:[{dark:"dark"===t.theme}]},[e("div",{staticClass:"nec-d1"},[t._m(0),e("p",{staticClass:"nec-content"},[t._v(t._s(t.local("No any Content")))]),e("p",{staticClass:"nec-content sec"},[t._v(t._s(t.local("Click + to Add New Item or Drag a PDF File to the Window")))])])])},F=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"nec-icon-block"},[e("img",{staticClass:"empty-emo",attrs:{draggable:"false",src:a("66b3"),alt:""}})])}],N={computed:{...Object(c["d"])({theme:t=>t.theme}),...Object(c["b"])(["local"])}},T=N,V=(a("07de"),Object(m["a"])(T,P,F,!1,null,null,null)),j=V.exports,L=a("36d6"),A=function(){var t=this,e=t._self._c;return e("float-window-base",{attrs:{title:t.local("Rename Page"),theme:t.theme},scopedSlots:t._u([{key:"content",fn:function(){return[e("div",{staticClass:"w-p-block"},[e("p",{staticClass:"w-title"},[t._v(t._s(t.local("Page Name")))]),e("fv-text-box",{staticStyle:{width:"100%",height:"60px","margin-top":"15px"},attrs:{placeholder:t.local("Input page name..."),theme:t.theme,"font-size":18,"font-weight":"bold",underline:"","focus-border-color":"rgba(123, 139, 209, 1)","is-box-shadow":!0},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.rename.apply(null,arguments)}},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1)]},proxy:!0},{key:"control",fn:function(){return[e("fv-button",{attrs:{theme:"dark",background:"rgba(0, 153, 204, 1)",disabled:!t.value||""===t.name||!t.cur_db},on:{click:t.rename}},[t._v(t._s(t.local("Confirm")))]),e("fv-button",{attrs:{theme:t.theme},on:{click:function(e){t.thisShow=!1}}},[t._v(t._s(t.local("Cancel")))])]},proxy:!0}]),model:{value:t.thisShow,callback:function(e){t.thisShow=e},expression:"thisShow"}})},M=[],E={components:{floatWindowBase:r["a"]},props:{value:{default:null},item:{default:null},show:{default:!1}},data(){return{thisShow:this.show,name:""}},watch:{show(t){this.thisShow=t},thisShow(t){this.$emit("update:show",t),this.value.name?this.name=this.value.name:this.name=""}},computed:{...Object(c["d"])({data_index:t=>t.data_index,data_path:t=>t.data_path,items:t=>t.data_structure.items,theme:t=>t.theme}),...Object(c["b"])(["local","cur_db"]),v(){return this}},methods:{...Object(c["c"])({reviseDS:"reviseDS"}),async rename(){if(!this.cur_db||!this.value||!this.item||""===this.name)return;let t=this.items.find(t=>t.id===this.item.id),e=t.pages.find(t=>t.id===this.value.id);e.name=this.name,this.value.name=this.name,this.reviseDS({$index:this.data_index,items:this.items}),this.thisShow=!1}}},J=E,B=Object(m["a"])(J,A,M,!1,null,null,null),K=B.exports,q=function(){var t=this,e=t._self._c;return e("fv-panel",{attrs:{theme:t.theme,width:"500",title:t.local("Metadata"),"is-light-dismiss":!0,isAcrylic:!0,isFooter:!0},scopedSlots:t._u([{key:"container",fn:function(){return[e("div",{staticClass:"metadata-container"},[e("div",{staticClass:"metadata-item"},[e("p",{staticClass:"title"},[t._v("Title")]),e("div",{staticClass:"row-block"},[e("fv-text-box",{staticStyle:{height:"45px","font-size":"20px",flex:"1"},attrs:{theme:t.theme,placeholder:t.local("Please Input title..."),underline:!0},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getMetaInfo.apply(null,arguments)}},model:{value:t.metadata.title,callback:function(e){t.$set(t.metadata,"title",e)},expression:"metadata.title"}}),e("fv-button",{staticStyle:{width:"35px",height:"35px","margin-left":"15px"},attrs:{theme:t.theme,title:t.local("Retrieve Metadata")},on:{click:t.getMetaInfo}},[e("i",{staticClass:"ms-Icon ms-Icon--Sync",class:[{circle:!t.lock.metaInfo}]})])],1)]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.metaInfoList.length>0,expression:"metaInfoList.length > 0"}],staticClass:"metadata-item"},[e("div",{staticClass:"row-block between"},[e("p",{staticClass:"title"},[t._v(t._s(t.local("Searching Metadata")))]),e("fv-button",{staticStyle:{width:"30px",height:"30px"},attrs:{theme:"dark",borderRadius:"35",background:"rgba(220, 62, 72, 1)"},on:{click:function(e){t.metaInfoList=[]}}},[e("i",{staticClass:"ms-Icon ms-Icon--Cancel"})])],1),e("transition-group",{staticStyle:{position:"relative",width:"100%"},attrs:{tag:"div",name:"move-left-to-right"}},t._l(t.metaInfoList,(function(a,i){return e("div",{key:`${a.title}-${i}`,staticClass:"meta-item"},[e("div",{staticClass:"title-block"},[e("i",{staticClass:"ms-Icon ms-Icon--RightDoubleQuote"}),e("p",{staticClass:"highlight",attrs:{title:a.title},on:{click:function(e){return t.updateMetadata(a)}}},[t._v(t._s(a.title))])]),e("div",{staticClass:"label-block"},[e("fv-button",{staticStyle:{"flex-shrink":"0"},attrs:{theme:"dark",background:"rgba(145, 145, 235, 1)"}},[t._v(t._s(a.year))]),e("fv-button",{directives:[{name:"show",rawName:"v-show",value:a.publisher,expression:"item.publisher"}],staticStyle:{width:"auto",margin:"0px 5px"},attrs:{theme:"dark",background:"rgba(0, 145, 235, 1)",title:a.publisher}},[e("p",{staticStyle:{padding:"0px 15px"}},[t._v(t._s(a.publisher))])])],1),e("div",{staticClass:"extension-block"},[e("p",[t._v(t._s(a.from))]),e("fv-button",{staticStyle:{width:"30px",height:"30px"},attrs:{theme:"dark",borderRadius:"35",fontSize:"12"},on:{click:()=>{a.expand^=!0,t.$set(t.metaInfoList,i,a)}}},[e("i",{staticClass:"ms-Icon",class:["ms-Icon--"+(a.expand?"DoubleChevronUp":"DoubleChevronDown")]})])],1),e("transition",{attrs:{name:a.expand?"move-top-to-bottom":"move-bottom-to-top"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:a.expand,expression:"item.expand"}],staticClass:"abstract-block"},[e("span",[t._v(t._s(a.abstract))])])])],1)})),0)],1),e("div",{staticClass:"metadata-item"},[e("p",{staticClass:"title"},[t._v("BibTex Tools")]),e("div",{staticClass:"row-block"},[e("fv-combobox",{staticStyle:{width:"200px"},attrs:{theme:t.theme,placeholder:t.local("Select Type"),options:t.bibTexOptions},model:{value:t.bibTexValue,callback:function(e){t.bibTexValue=e},expression:"bibTexValue"}}),e("fv-button",{staticStyle:{width:"135px",height:"35px","margin-left":"15px"},attrs:{theme:t.theme,disabled:!t.bibTexValue.key,isBoxShadow:!0,icon:"SemiboldWeight"},on:{click:t.generateBibTex}},[t._v(" "+t._s(t.local("Generate BibTex"))+" ")])],1),e("textarea",{directives:[{name:"show",rawName:"v-show",value:t.bibTexContent,expression:"bibTexContent"},{name:"model",rawName:"v-model",value:t.bibTexContent,expression:"bibTexContent"}],staticClass:"text-area",class:{dark:"dark"==t.theme},staticStyle:{width:"100%",margin:"5px 0px","font-size":"12px"},attrs:{placeholder:t.local("BibTex Content")},domProps:{value:t.bibTexContent},on:{input:function(e){e.target.composing||(t.bibTexContent=e.target.value)}}})]),e("div",{staticClass:"metadata-item"},[e("p",{staticClass:"title"},[t._v("Publisher")]),e("fv-text-box",{attrs:{theme:t.theme,placeholder:t.local("Please Input publisher...")},model:{value:t.metadata.publisher,callback:function(e){t.$set(t.metadata,"publisher",e)},expression:"metadata.publisher"}})],1),e("div",{staticClass:"metadata-item"},[e("p",{staticClass:"title"},[t._v("Year")]),e("fv-text-box",{attrs:{theme:t.theme,placeholder:t.local("Please Input year...")},model:{value:t.metadata.year,callback:function(e){t.$set(t.metadata,"year",e)},expression:"metadata.year"}})],1),e("div",{staticClass:"metadata-item"},[e("p",{staticClass:"title"},[t._v("DOI")]),e("fv-text-box",{attrs:{theme:t.theme,placeholder:t.local("Please Input DOI...")},model:{value:t.metadata.DOI,callback:function(e){t.$set(t.metadata,"DOI",e)},expression:"metadata.DOI"}})],1),e("div",{staticClass:"metadata-item"},[e("p",{staticClass:"title"},[t._v("CreateDate")]),e("fv-text-box",{attrs:{theme:t.theme,placeholder:t.local("Please Input createDate...")},model:{value:t.metadata.createDate,callback:function(e){t.$set(t.metadata,"createDate",e)},expression:"metadata.createDate"}})],1),e("div",{staticClass:"metadata-item"},[e("p",{staticClass:"title"},[t._v("Source")]),e("fv-text-box",{attrs:{theme:t.theme,placeholder:t.local("Please Input source...")},model:{value:t.metadata.source,callback:function(e){t.$set(t.metadata,"source",e)},expression:"metadata.source"}})],1),e("div",{staticClass:"metadata-item"},[e("p",{staticClass:"title"},[t._v("Url")]),e("fv-text-box",{attrs:{theme:t.theme,placeholder:t.local("Please Input url...")},model:{value:t.metadata.url,callback:function(e){t.$set(t.metadata,"url",e)},expression:"metadata.url"}})],1),e("div",{staticClass:"metadata-item"},[e("p",{staticClass:"title"},[t._v("ContainerTitle")]),e("fv-text-box",{attrs:{theme:t.theme,placeholder:t.local("Please Input containerTitle...")},model:{value:t.metadata.containerTitle,callback:function(e){t.$set(t.metadata,"containerTitle",e)},expression:"metadata.containerTitle"}})],1),e("div",{staticClass:"metadata-item"},[e("p",{staticClass:"title"},[t._v("Abstract")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.metadata.abstract,expression:"metadata.abstract"}],staticClass:"text-area",class:{dark:"dark"==t.theme},attrs:{placeholder:t.local("Please Input abstract...")},domProps:{value:t.metadata.abstract},on:{input:function(e){e.target.composing||t.$set(t.metadata,"abstract",e.target.value)}}})]),e("div",{staticClass:"metadata-item"},[e("p",{staticClass:"title"},[t._v("ISSN")]),e("fv-text-box",{attrs:{theme:t.theme,placeholder:t.local("Please Input ISSN...")},model:{value:t.metadata.ISSN,callback:function(e){t.$set(t.metadata,"ISSN",e)},expression:"metadata.ISSN"}})],1),e("div",{staticClass:"metadata-item"},[e("p",{staticClass:"title"},[t._v("Language")]),e("fv-text-box",{attrs:{theme:t.theme,placeholder:t.local("Please Input language...")},model:{value:t.metadata.language,callback:function(e){t.$set(t.metadata,"language",e)},expression:"metadata.language"}})],1),e("div",{staticClass:"metadata-item"},[e("p",{staticClass:"title"},[t._v("Chapter")]),e("fv-text-box",{attrs:{theme:t.theme,placeholder:t.local("Please Input chapter...")},model:{value:t.metadata.chapter,callback:function(e){t.$set(t.metadata,"chapter",e)},expression:"metadata.chapter"}})],1),e("div",{staticClass:"metadata-item"},[e("p",{staticClass:"title"},[t._v("Pages")]),e("fv-text-box",{attrs:{theme:t.theme,placeholder:t.local("Please Input pages...")},model:{value:t.metadata.pages,callback:function(e){t.$set(t.metadata,"pages",e)},expression:"metadata.pages"}})],1),e("div",{staticClass:"metadata-item"},[e("p",{staticClass:"title"},[t._v("Note")]),e("fv-text-box",{attrs:{theme:t.theme,placeholder:t.local("Please Input note...")},model:{value:t.metadata.note,callback:function(e){t.$set(t.metadata,"note",e)},expression:"metadata.note"}})],1),e("div",{staticClass:"metadata-item"},[e("p",{staticClass:"title"},[t._v("School")]),e("fv-text-box",{attrs:{theme:t.theme,placeholder:t.local("Please Input school...")},model:{value:t.metadata.school,callback:function(e){t.$set(t.metadata,"school",e)},expression:"metadata.school"}})],1),e("div",{staticClass:"metadata-item"},[e("p",{staticClass:"title"},[t._v("Authors")]),e("fv-button",{directives:[{name:"show",rawName:"v-show",value:0===t.metadata.authors.length,expression:"metadata.authors.length === 0"}],attrs:{theme:"dark",background:"rgba(0, 204, 153, 1)",borderRadius:"50"},on:{click:function(e){return t.addAuthor(0)}}},[e("i",{staticClass:"ms-Icon ms-Icon--Add"})]),t._l(t.metadata.authors,(function(a,i){return e("div",{key:i,staticClass:"author-block"},[e("fv-button",{staticClass:"control-btn",attrs:{theme:"dark",background:"rgba(173, 38, 45, 1)",borderRadius:"50"},on:{click:function(e){return t.delAuthor(i)}}},[e("i",{staticClass:"ms-Icon ms-Icon--Remove"})]),e("fv-text-box",{staticStyle:{margin:"0px 3px"},attrs:{placeholder:t.local("First Name"),theme:t.theme},model:{value:a.first,callback:function(e){t.$set(a,"first",e)},expression:"author.first"}}),e("fv-text-box",{staticStyle:{margin:"0px 3px"},attrs:{placeholder:t.local("Last Name"),theme:t.theme},model:{value:a.last,callback:function(e){t.$set(a,"last",e)},expression:"author.last"}}),e("fv-text-box",{staticStyle:{margin:"0px 3px"},attrs:{placeholder:t.local("Sequence"),theme:t.theme},model:{value:a.sequence,callback:function(e){t.$set(a,"sequence",e)},expression:"author.sequence"}}),e("fv-button",{staticClass:"control-btn",attrs:{theme:"dark",background:"rgba(0, 204, 153, 1)",borderRadius:"50"},on:{click:function(e){return t.addAuthor(i)}}},[e("i",{staticClass:"ms-Icon ms-Icon--Add"})])],1)}))],2)])]},proxy:!0},{key:"footer",fn:function(){return[e("fv-button",{attrs:{theme:"dark",background:"rgba(0, 90, 158, 1)"},on:{click:t.save}},[t._v(t._s(t.local("Confirm")))]),e("fv-button",{staticStyle:{"margin-left":"5px"},attrs:{theme:t.theme},on:{click:function(e){t.thisValue=!1}}},[t._v(t._s(t.local("Cancel")))])]},proxy:!0}]),model:{value:t.thisValue,callback:function(e){t.thisValue=e},expression:"thisValue"}})},R=[];class W{static async cref_getInfoByTitle(t,e){let a="https://api.crossref.org/works";t=t.replace(/ +/g,"+");try{return await new Promise(i=>{e.get(a,{params:{"query.bibliographic":t}},{timeout:1e4}).then(t=>{i(W.formatCref(t.data.message.items))}).catch(t=>{console.log(t),i([])})})}catch(i){return[]}}static formatCref(t){let e=[];return t.forEach(t=>{let a=JSON.parse(JSON.stringify(n["e"])),i=[];a.title=t.title[0],a.DOI=t.DOI,a.abstract=t.abstract,a.ISSN=t.ISSN?t.ISSN[0]:"",a.containerTitle=t["container-title"]?t["container-title"][0]:"",a.createDate=t.created?t.created["date-time"]:"",a.language=t.language,a.publisher=t.publisher,a.source=t.source,a.url=t.URL,t.author&&t.author.forEach(t=>{let e=JSON.parse(JSON.stringify(n["a"]));e.first=t.first||t.given,e.last=t.last||t.family,e.sequence=t.sequence,i.push(e)}),a.authors=i,""!=a.createDate&&(a.year=new Date(a.createDate).getFullYear().toString()),a.from="CrossRef",e.push(a)}),e}static async semanticScholar_getInfoByTitle(t,e){let a="https://api.semanticscholar.org/graph/v1/paper/search";t=t.replace(/ +/g,"+");try{return await new Promise(i=>{e.get(a,{params:{query:t,fields:"url,title,abstract,authors,year,venue,fieldsOfStudy"}},{timeout:1e4}).then(t=>{i(W.formatSemanticScholar(t.data.data))}).catch(t=>{console.log(t),i([])})})}catch(i){return[]}}static formatSemanticScholar(t){let e=[];return t.forEach(t=>{let a=JSON.parse(JSON.stringify(n["e"])),i=[];a.title=t.title,a.abstract=t.abstract,a.year=t.year.toString(),a.publisher=t.venue,a.url=t.url,t.authors.forEach((t,e)=>{let a=JSON.parse(JSON.stringify(n["a"])),s=t["name"].split(" ");a.first=s[0],s.length>1&&(a.last=s.slice(1).join(" ")),a.sequence=0==e?"first":"additional",i.push(a)}),a.authors=i,a.from="Semantic Scholar",e.push(a)}),e}static titleSimilar(t,e,a){if(!t||!e)return 0;var i=t.length>e.length?t.length:e.length,s=t.length,o=e.length,l=[];a=a||3;var r,n,c,h,d,u=function(t,e,a){return t<e?t<a?t:a:e<a?e:a};if(0===s)return o;if(0===o)return s;for(r=0;r<=s;r++)l[r]=[],l[r][0]=r;for(n=0;n<=o;n++)l[0][n]=n;for(r=1;r<=s;r++)for(c=t.charAt(r-1),n=1;n<=o;n++)h=e.charAt(n-1),d=c===h?0:1,l[r][n]=u(l[r-1][n]+1,l[r][n-1]+1,l[r-1][n-1]+d);let m=1-l[s][o]/i;return m.toFixed(a)}}var z={props:{value:{default:!1},item:{default:null}},data(){return{thisValue:this.value,metaAPI:W,metaInfoList:[],metadata:{publisher:"",DOI:"",year:"",createDate:"",source:"",title:"",url:"",containerTitle:"",abstract:"",ISSN:"",language:"",chapter:"",pages:"",school:"",note:"",authors:[]},bibTexValue:{},bibTexOptions:[{key:"article",text:"Article",required:{author:"author",title:"title",journal:"publisher",year:"year"}},{key:"book",text:"Book",required:{author:"author",title:"title",publisher:"publisher",year:"year"}},{key:"booklet",text:"Booklet",required:{title:"title"}},{key:"inbook",text:"Inbook",required:{author:"author",title:"title",publisher:"publisher",year:"year",chapter:"chapter",pages:"pages"}},{key:"incollection",text:"Incollection",required:{author:"author",title:"title",publisher:"publisher",year:"year",booktitle:"containerTitle"}},{key:"conference",text:"Conference",required:{author:"author",title:"title",publisher:"publisher",year:"year",booktitle:"containerTitle"}},{key:"inproceedings",text:"Inproceedings",required:{author:"author",title:"title",publisher:"publisher",year:"year",booktitle:"containerTitle"}},{key:"manual",text:"Manual",required:{title:"title"}},{key:"mastersthesis",text:"Mastersthesis",required:{author:"author",title:"title",school:"school",year:"year"}},{key:"misc",text:"Misc",required:{title:"title"}},{key:"phdthesis",text:"Phdthesis",required:{author:"author",title:"title",school:"school",year:"year"}},{key:"proceedings",text:"Proceedings",required:{title:"title",year:"year"}},{key:"techreport",text:"Techreport",required:{author:"author",title:"title",institution:"publisher",year:"year"}},{key:"unpublished",text:"Unpublished",required:{author:"author",title:"title",note:"note"}}],bibTexContent:"",lock:{metaInfo:!0}}},watch:{value(t){this.thisValue=t},thisValue(t){this.$emit("input",t)},item(){this.metadataInit(),this.metaInfoList=[],this.lock.metaInfo=!0,this.bibTexContent=""}},computed:{...Object(c["d"])({data_path:t=>t.data_path,data_index:t=>t.data_index,items:t=>t.data_structure.items,theme:t=>t.theme}),...Object(c["b"])(["local","cur_db"])},mounted(){this.metadataInit()},methods:{...Object(c["c"])({reviseDS:"reviseDS"}),metadataInit(){if(this.item.metadata){for(let t in this.metadata)this.item.metadata[t]?"object"===typeof this.item.metadata[t]?this.metadata[t]=this.item.metadata[t]:this.metadata[t]=this.item.metadata[t].toString():this.metadata[t]="";this.item.metadata.authors||(this.metadata.authors=[])}},addAuthor(t=0){this.metadata.authors.splice(t,0,JSON.parse(JSON.stringify(n["a"])))},delAuthor(t){this.metadata.authors.splice(t,1)},async getMetaInfo(){if(!this.lock.metaInfo)return;if(!this.metadata.title)return;this.lock.metaInfo=!1;let t=[],e=[this.metaAPI.cref_getInfoByTitle,this.metaAPI.semanticScholar_getInfoByTitle];for(let i of e)t.push(i(this.metadata.title,this.axios));let a=[];await Promise.all(t).then(t=>{t.forEach(t=>{a=a.concat(t)})}),a.sort((t,e)=>this.metaAPI.titleSimilar(e.title,this.metadata.title)-this.metaAPI.titleSimilar(t.title,this.metadata.title)),this.metaInfoList=a,this.lock.metaInfo=!0},updateMetadata(t){Object.assign(this.metadata,t)},async save(){let t=this.items.find(t=>t.id===this.item.id);t.metadata=JSON.parse(JSON.stringify(this.metadata)),this.item.metadata=JSON.parse(JSON.stringify(this.metadata)),this.reviseDS({$index:this.data_index,items:this.items}),await this.saveMetadata(this.metadata,t.id),this.thisValue=!1},async saveMetadata(t,e=null){console.log(e)},generateBibTex(){let t=this.bibTexValue.required,e={};for(let s in t)if("author"==s){if(!this.metadata.authors.length>0)return void this.$barWarning(`'${s}' ${this.local("is required")}`,{status:"warning"});this.metadata.authors.forEach(t=>{let a=`${t.last}, ${t.first}`;e.name?e.name+=" and "+a:e.name=a})}else{if(!this.metadata[t[s]])return void this.$barWarning(`'${t[s]}' ${this.local("is required")}`,{status:"warning"});e[s]=this.metadata[t[s]]}let a=()=>{let t="";for(let a in e)t+=`${a} = {${e[a]}},\n`;return t},i=`@${this.bibTexValue.key} {ikfb${this.$Guid()},\n                ${a()}\n            }`;this.bibTexContent=i,this.$barWarning(this.local("Successfully copied to clipboard"),{status:"correct"})}}},U=z,Y=(a("504f"),Object(m["a"])(U,q,R,!1,null,null,null)),H=Y.exports,X=function(){var t=this,e=t._self._c;return t.cur_db?e("float-window-base",{attrs:{title:t.title,theme:t.theme},scopedSlots:t._u([{key:"content",fn:function(){return[e("div",{staticClass:"tree-view-window"},[e("fv-TreeView",{staticStyle:{width:"100%",height:"100%",overflow:"auto"},attrs:{checkable:!0,theme:t.theme,expandedIconPosition:"right",background:"dark"==t.theme?"rgba(45, 45, 45, 1)":"rgba(255, 255, 255, 1)","view-style":{backgroundColor:"dark"==t.theme?"rgba(45, 45, 45, 1)":"rgba(255, 255, 255, 1)",backgroundColorHover:"dark"==t.theme?"rgba(200, 200, 200, 0.1)":"rgba(255, 255, 255, 1)"}},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"tree-view-custom-item"},[e("p",[t._v(t._s(a.item.emoji))]),e("p",{staticClass:"tree-view-custom-label"},[t._v(t._s(a.item.name))])])]}}],null,!1,1120196602),model:{value:t.treeList,callback:function(e){t.treeList=e},expression:"treeList"}})],1)]},proxy:!0},{key:"control",fn:function(){return[e("fv-button",{attrs:{theme:"dark",background:"rgba(0, 153, 204, 1)",disabled:!t.cur_db||!t.confirmDisable},on:{click:t.confirm}},[t._v(t._s(t.local("Confirm")))]),e("fv-button",{attrs:{theme:t.theme},on:{click:function(e){t.thisValue=!1}}},[t._v(t._s(t.local("Cancel")))])]},proxy:!0}],null,!1,792328605),model:{value:t.thisValue,callback:function(e){t.thisValue=e},expression:"thisValue"}}):t._e()},G=[],Q={components:{floatWindowBase:r["a"]},props:{value:{default:!1},title:{default:"Folder"}},data(){return{thisValue:this.value,treeList:[]}},watch:{value(t){this.thisValue=t},thisValue(t){t&&this.refreshTreeList(),this.$emit("input",t)}},computed:{...Object(c["d"])({data_index:t=>t.data_index,data_path:t=>t.data_path,groups:t=>t.data_structure.groups,partitions:t=>t.data_structure.partitions,theme:t=>t.theme}),...Object(c["b"])(["local","cur_db"]),v(){return this},confirmDisable(){let t=[].concat(this.treeList),e=[];for(let a=0;a<t.length;a++)t[a].children&&(t=t.concat(t[a].children)),"partition"===t[a].type&&e.push(t[a]),t[a].partitions&&(e=e.concat(t[a].partitions));for(let a=0;a<e.length;a++)if(e[a].selected)return!0;return!1}},mounted(){this.refreshTreeList()},methods:{...Object(c["c"])({reviseDS:"reviseDS"}),refreshTreeList(){let t=[],e=JSON.parse(JSON.stringify(this.groups));e.forEach(e=>{let a=this.dfsTree(e);t.push(a)}),t=t.concat(this.transPartitions(this.partitions)),this.treeList=t},dfsTree(t){let e=JSON.parse(JSON.stringify(t));if(e.selected=!1,e.children=e.groups,e.editable=void 0!=e.editable&&e.editable,e.type="group",e.icon="Folder",void 0==e.children||0==e.children.length)return e.children=this.transPartitions(e.partitions),e;for(let a=0;a<e.children.length;a++)e.children[a]=this.dfsTree(e.children[a]);return e.children=e.children.concat(this.transPartitions(e.partitions)),e},transPartitions(t){let e=JSON.parse(JSON.stringify(t));return e.forEach((t,a)=>{t.selected=!1,t.editable=void 0!=t.editable&&t.editable,t.type="partition",t.icon="FileCode",e[a]=t}),e},confirm(){let t=[].concat(this.treeList),e=[],a=[];for(let i=0;i<t.length;i++)t[i].children&&(t=t.concat(t[i].children)),"partition"===t[i].type&&e.push(t[i]),t[i].partitions&&(e=e.concat(t[i].partitions));for(let i=0;i<e.length;i++)e[i].selected&&a.push(e[i].id);this.$emit("choose-partitions",a),this.thisValue=!1}}},Z=Q,tt=(a("3524"),Object(m["a"])(Z,X,G,!1,null,null,null)),et=tt.exports;const at=a("cad9");var it={components:{addItem:f,renameItem:y,mainList:D,itemListEmpty:j,addItemPage:L["a"],renameItemPage:K,metadataPanel:H,folderWindow:et,emojiCallout:C["a"]},data(){return{cmd:[{name:()=>this.local("Add"),icon:"Add",iconColor:"rgba(0, 90, 158, 1)",disabled:()=>null===this.cur_db||!this.lock,func:()=>{this.show.add=!0}},{name:()=>this.local("Import"),icon:"Upload",iconColor:"rgba(0, 90, 158, 1)",disabled:()=>null===this.cur_db||!this.lock,func:()=>{this.$barWarning(this.local("Function is not supported yet."),{status:"warning"})}},{name:()=>this.editable?this.local("Cancel Multi-Selection"):this.local("Multi-Selection"),icon:"MultiSelect",iconColor:"rgba(0, 90, 158, 1)",disabled:()=>null===this.cur_db||!this.lock,func:()=>{this.editable^=!0}},{name:()=>this.local("Copy to Partitions"),icon:"FabricMovetoFolder",iconColor:"rgba(0, 90, 158, 1)",disabled:()=>0===this.currentChoosen.length||!this.lock,func:()=>{this.show.folder=!0}},{name:()=>this.local("Remove From Partition"),icon:"RemoveFrom",iconColor:"rgba(220, 62, 72, 1)",disabled:()=>0===this.currentChoosen.length||!this.lock||!1===this.pid,func:this.deleteItemsFromPartition},{name:()=>this.local("Delete"),icon:"Delete",iconColor:"rgba(220, 62, 72, 1)",disabled:()=>0===this.currentChoosen.length||!this.lock||!1!==this.pid,func:this.deleteItems}],sortKey:{},sortOptions:[{key:"name",text:()=>this.local("Name")},{key:"title",text:()=>this.local("Title")},{key:"publisher",text:()=>this.local("Publisher")},{key:"createDate",text:()=>this.local("Create Date")},{key:"year",text:()=>this.local("Year")}],sortDesc:1,editable:!1,filterItems:[],currentItem:{},currentChoosen:[],currentItemPage:{},currentSearch:"",show:{add:!1,rename:!1,addItemPage:!1,renameItemPage:!1,metadata:!1,folder:!1},lock:!0}},watch:{$route(){this.itemsEnsureFolder(),this.refreshFilterItems()},items(){this.refreshFilterItems()}},computed:{...Object(c["d"])({root:t=>t.root,data_path:t=>t.data_path,data_index:t=>t.data_index,items:t=>t.data_structure.items,groups:t=>t.data_structure.groups,partitions:t=>t.data_structure.partitions,theme:t=>t.theme}),...Object(c["b"])(["local","cur_db"]),v(){return this},pid(){return void 0!==this.$route.params.id&&this.$route.params.id},pname(){if(!1===this.pid)return"Unknown";let t=[].concat(this.groups),e=[];for(let a=0;a<t.length;a++)t[a].groups&&(t=t.concat(t[a].groups)),t[a].partitions&&(e=e.concat(t[a].partitions));e=e.concat(this.partitions);for(let a=0;a<e.length;a++)if(e[a].id===this.pid)return e[a].name;return"Unknown"},filterItemsId(){if(!1===this.pid)return!0;let t=[].concat(this.groups),e=[],a=[];for(let i=0;i<t.length;i++)t[i].groups&&(t=t.concat(t[i].groups)),t[i].partitions&&(e=e.concat(t[i].partitions));e=e.concat(this.partitions);for(let i=0;i<e.length;i++)if(e[i].id===this.pid){a=JSON.parse(JSON.stringify(e[i].items));break}return a}},mounted(){this.itemsEnsureFolder(),this.refreshFilterItems()},methods:{...Object(c["c"])({reviseDS:"reviseDS",reviseEditor:"reviseEditor",toggleEditor:"toggleEditor"}),refreshFilterItems(){if(!0===this.filterItemsId)this.filterItems=this.items;else{let t=[];this.items.forEach((e,a)=>{this.filterItemsId.indexOf(e.id)>-1&&t.push(this.items[a])}),this.filterItems=t}},async itemsEnsureFolder(){if(this.cur_db&&-1!=this.data_index&&(this.lock=!1,null!==this.root))try{await this.root.path().createListAsync({name:"root",conflict:h["ConflictBehavior"].Fail}),await this.root.path("root").createListAsync({name:"items",conflict:h["ConflictBehavior"].Fail})}catch{}finally{try{await this.root.path("root/items").getAsync(),this.lock=!0}catch{}}},deleteItem(){this.currentItem.id&&this.lock&&this.$infoBox(this.local("Are you sure to delete this item?"),{status:"error",title:this.local("Delete Item"),confirmTitle:this.local("Confirm"),cancelTitle:this.local("Cancel"),theme:this.theme,confirm:async()=>{console.log("delete"),this.lock=!1;let t=this.items.indexOf(this.items.find(t=>t.id===this.currentItem.id));this.items.splice(t,1),this.reviseDS({$index:this.data_index,items:this.items}),await this.root.clone().path("root/items/"+this.currentItem.id).delAsync(),this.delItemsFromPs([this.currentItem.id]),this.lock=!0,console.log(this.currentItem.id)},cancel:()=>{}})},deleteItems(){this.currentChoosen&&this.lock&&this.$infoBox(this.local("Are you sure to delete these items?"),{status:"error",title:this.local("Delete Items"),confirmTitle:this.local("Confirm"),cancelTitle:this.local("Cancel"),theme:this.theme,confirm:async()=>{this.lock=!1;let t=[],e=JSON.parse(JSON.stringify(this.currentChoosen));for(let a of e){t.push(a.id);let e=this.items.indexOf(this.items.find(t=>t.id===a.id));this.items.splice(e,1),this.reviseDS({$index:this.data_index,items:this.items}),await this.root.clone().path("root/items/"+a.id).delAsync(),this.delItemsFromPs(t),this.currentChoosen=[],this.lock=!0}},cancel:()=>{}})},delItemsFromPs(t){if(0===t.length)return;let e=[].concat(this.groups),a=[];for(let i=0;i<e.length;i++)e[i].groups&&(e=e.concat(e[i].groups)),e[i].partitions&&(a=a.concat(e[i].partitions));a=a.concat(this.partitions),a.forEach((e,i)=>{for(let a=0;a<t.length;a++){let i=e.items.indexOf(t[a]);i>-1&&e.items.splice(i,1)}a[i].items=e.items})},reviseItemPdf(){this.revisePdfImporter({mode:"item",item:this.currentItem}),setTimeout(()=>{this.pdf_importer.inputInspectClick()},300)},importPdf(){this.revisePdfImporter({mode:"import"}),setTimeout(()=>{this.pdf_importer.inputInspectClick()},300)},openEditor(t,e){this.reviseEditor({type:"item",item:t,target:e,scrollTop:0,history:[]}),this.toggleEditor(!0)},async openFile(t){let e=at.join(this.data_path[this.data_index],"root/items",t),a=await this.cur_db.getFileInfo(e);this.$Jump(a.webUrl)},copyItemsToPartitions(t){let e=[].concat(this.groups),a=[],i=[];for(let o=0;o<e.length;o++)e[o].groups&&(e=e.concat(e[o].groups)),e[o].partitions&&(a=a.concat(e[o].partitions));a=a.concat(this.partitions);for(let o=0;o<a.length;o++)t.indexOf(a[o].id)>-1&&i.push(a[o]);let s=this.currentChoosen;void 0===this.currentChoosen.find(t=>t.id===this.currentItem.id)&&s.push(this.currentItem),0!==s.length&&(i.forEach((t,e)=>{for(let a=0;a<s.length;a++)void 0===t.items.find(t=>t===s[a].id)&&t.items.push(s[a].id);i[e].items=t.items}),this.currentChoosen=[],this.reviseDS({$index:this.data_index,groups:this.groups,partitions:this.partitions}))},deleteItemsFromPartition(){if(!1===this.pid)return;let t=[].concat(this.groups),e=[],a={};for(let s=0;s<t.length;s++)t[s].groups&&(t=t.concat(t[s].groups)),t[s].partitions&&(e=e.concat(t[s].partitions));e=e.concat(this.partitions);for(let s=0;s<e.length;s++)if(e[s].id===this.pid){a=e[s];break}let i=this.currentChoosen;if(void 0===this.currentChoosen.find(t=>t.id===this.currentItem.id)&&i.push(this.currentItem),0!==i.length){for(let t=0;t<i.length;t++){let e=a.items.indexOf(i[t].id);e>-1&&a.items.splice(e,1)}this.currentChoosen=[],this.reviseDS({$index:this.data_index,groups:this.groups,partitions:this.partitions}),this.refreshFilterItems()}},showRenameItemPage(t,e){this.currentItem=t,this.currentItemPage=e,this.show.renameItemPage=!0},showMetadata(t){this.currentItem=t,this.show.metadata=!0},reviseItemEmoji(t,e){if(!this.cur_db||!this.items)return;let a=this.items.find(e=>e.id===t.id);a.emoji=e,t.emoji=e,this.reviseDS({$index:this.data_index,items:this.items})},revisePageEmoji(t,e,a){if(!this.cur_db||!this.items)return;let i=this.items.find(e=>e.id===t.id),s=i.pages.find(t=>t.id===e.id);s.emoji=a,e.emoji=a,this.reviseDS({$index:this.data_index,items:this.items}),this.thisShow=!1},async deleteItemPage(t,e){this.$infoBox(this.local("Are you sure to delete this page?"),{status:"error",title:this.local("Delete Page"),confirmTitle:this.local("Confirm"),cancelTitle:this.local("Cancel"),theme:this.theme,confirm:async()=>{let a=this.items.find(e=>e.id===t),i=a.pages.indexOf(e);a.pages.splice(i,1),await this.reviseDS({$index:this.data_index,items:this.items}),await this.root.clone().path(`root/items/${a.id}/${e}.json`).delAsync()},cancel:()=>{}})}}},st=it,ot=(a("6b01"),Object(m["a"])(st,i,s,!1,null,null,null));e["default"]=ot.exports},d638:function(t,e,a){}}]);
//# sourceMappingURL=chunk-40b851e8.78a4543a.js.map