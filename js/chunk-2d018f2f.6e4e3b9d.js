(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d018f2f"],{"386c":function(t,e,a){},"42d3":function(t,e,a){},"61c2":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"settings-container",class:[{dark:"dark"===t.theme}]},[e("div",{staticClass:"s-row"},[e("p",{staticClass:"s-title"},[t._v(t._s(t.local("Setting")))])]),e("div",{staticClass:"scroll-view"},[e("div",{staticClass:"s-item-block"},[e("fv-button",{directives:[{name:"show",rawName:"v-show",value:!t.userInfo,expression:"!userInfo"}],staticStyle:{width:"150px"},attrs:{theme:"dark","is-box-shadow":!0,background:"rgba(0, 90, 158, 1)"},on:{click:t.login}},[t._v(t._s(t.local("Login")))])],1),e("fv-Collapse",{staticStyle:{width:"calc(100% - 15px)","max-width":"1280px","margin-top":"35px"},attrs:{disabledCollapse:!0,theme:t.theme,icon:"StorageTape",title:t.local("Source"),content:t.local("Add New Source")},scopedSlots:t._u([{key:"extension",fn:function(){return[e("fv-button",{staticStyle:{width:"120px"},attrs:{theme:t.theme,icon:"OneDriveAdd","is-box-shadow":!0},on:{click:function(e){t.show.addDS=!0}}},[t._v(t._s(t.local("Add")))])]},proxy:!0}])}),e("div",{staticClass:"s-item-block"},[e("fv-list-view",{staticStyle:{width:"100%",height:"auto","margin-top":"15px"},attrs:{value:t.thisDBList,theme:t.theme},on:{chooseItem:function(e){return t.switchDSDB(e)}},scopedSlots:t._u([{key:"listItem",fn:function(a){return[e("div",{staticClass:"list-view-item",class:[{choosen:t.data_index===a.index,disabled:t.SourceIndexDisabled(a.index)}]},[e("img",{staticClass:"icon-img",attrs:{draggable:"false",src:t.img.OneDrive,alt:""}}),e("p",{staticClass:"item-name"},[t._v(t._s(a.item.name))]),e("fv-button",{staticClass:"control-btn",attrs:{theme:t.theme,title:t.local("Unlink this source")},on:{click:function(e){return t.removeDS(a.item)}}},[e("i",{staticClass:"ms-Icon ms-Icon--RemoveLink"})])],1)]}}])})],1),e("fv-Collapse",{staticStyle:{width:"calc(100% - 15px)","max-width":"1280px","margin-top":"15px"},attrs:{disabledCollapse:!0,theme:t.theme,icon:"Color",title:t.local("Theme"),content:"light"===t.theme?""+t.local("Light"):""+t.local("Dark")},scopedSlots:t._u([{key:"extension",fn:function(){return[e("fv-button",{staticStyle:{width:"40px",height:"40px"},attrs:{theme:t.theme,fontSize:"16",borderRadius:"50","is-box-shadow":!0,title:"light"===t.theme?""+t.local("Switch to the dark theme"):""+t.local("Switch to the light theme")},on:{click:function(e){return t.toggleTheme(t.v)}}},[e("i",{staticClass:"ms-Icon",class:["ms-Icon--"+("light"===t.theme?"Sunny":"ClearNight")]})])]},proxy:!0}])}),e("fv-Collapse",{staticStyle:{width:"calc(100% - 15px)","max-width":"1280px","margin-top":"3px"},attrs:{disabledCollapse:!0,theme:t.theme,icon:"LocaleLanguage",title:t.local("Language"),content:t.local("Choose A Language")},scopedSlots:t._u([{key:"extension",fn:function(){return[e("fv-Combobox",{staticStyle:{width:"120px"},attrs:{theme:t.theme,options:t.languages,placeholder:t.local("Choose A Language"),background:"dark"===t.theme?"rgba(36, 36, 36, 1)":""},on:{"choose-item":t.chooseLanguage},model:{value:t.cur_language,callback:function(e){t.cur_language=e},expression:"cur_language"}})]},proxy:!0}])}),e("fv-Collapse",{staticStyle:{width:"calc(100% - 15px)","max-width":"1280px","margin-top":"3px"},attrs:{disabledCollapse:!0,theme:t.theme,icon:"PowerButton",title:t.local("Logout"),content:t.local("Logout")},scopedSlots:t._u([{key:"extension",fn:function(){return[e("fv-button",{staticStyle:{width:"120px"},attrs:{theme:"dark","is-box-shadow":!0,background:"rgba(224, 130, 128, 1)"},on:{click:t.logout}},[t._v(t._s(t.local("Logout")))])]},proxy:!0}])})],1),e("add-ds",{attrs:{show:t.show.addDS,theme:t.theme},on:{"update:show":function(e){return t.$set(t.show,"addDS",e)}}})],1)},s=[],o=a("bcbe"),n=function(){var t=this,e=t._self._c;return e("float-window-base",{attrs:{title:t.local("Init New Data Source"),theme:t.theme},scopedSlots:t._u([{key:"content",fn:function(){return[e("div",{staticClass:"w-p-block",staticStyle:{height:"100%"}},[e("p",{staticClass:"w-title"},[t._v(t._s(t.local("Data Source Name")))]),e("fv-Breadcrumb",{staticStyle:{width:"100%",height:"30px","margin-top":"15px"},attrs:{theme:t.theme,readOnly:!1},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addDS.apply(null,arguments)}},model:{value:t.path,callback:function(e){t.path=e},expression:"path"}}),e("div",{directives:[{name:"show",rawName:"v-show",value:t.lock.loading,expression:"lock.loading"}],staticClass:"tree-view-window"},[e("fv-TreeView",{staticStyle:{width:"100%",height:"100%",overflow:"auto"},attrs:{theme:t.theme,expandedIconPosition:"right",background:"dark"==t.theme?"rgba(45, 45, 45, 1)":"rgba(255, 255, 255, 1)","view-style":{backgroundColor:"dark"==t.theme?"rgba(45, 45, 45, 1)":"rgba(255, 255, 255, 1)",backgroundColorHover:"dark"==t.theme?"rgba(200, 200, 200, 0.1)":"rgba(255, 255, 255, 1)"}},on:{click:t.expandItem},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"tree-view-custom-item"},[a.item.loading?e("fv-progress-ring",{staticStyle:{display:"flex","align-item":"center"},attrs:{loading:"true",r:"10",borderWidth:"2",background:"rgba(200, 200, 200, 0.1)"}}):e("img",{staticClass:"icon-img",attrs:{draggable:"false",src:a.item.icon,alt:""}}),e("p",{staticClass:"tree-view-custom-label"},[t._v(t._s(a.item.name))])],1)]}}]),model:{value:t.treeList,callback:function(e){t.treeList=e},expression:"treeList"}})],1),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.lock.loading,expression:"!lock.loading"}],staticClass:"loading-block"},[e("fv-img",{staticStyle:{width:"90px",height:"auto",margin:"15px"},attrs:{draggable:"false",src:t.img.OneDrive}}),e("fv-progress-ring",{attrs:{loading:"true",r:"15",borderWidth:"3",background:"rgba(200, 200, 200, 0.1)"}})],1)],1)]},proxy:!0},{key:"control",fn:function(){return[e("fv-button",{attrs:{theme:"dark",background:"rgba(0, 153, 204, 1)",disabled:""===t.path},on:{click:t.addDS}},[t._v(" "+t._s(t.local("Confirm")))]),e("fv-button",{attrs:{theme:t.theme},on:{click:function(e){t.thisShow=!1}}},[t._v(t._s(t.local("Cancel")))])]},proxy:!0}]),model:{value:t.thisShow,callback:function(e){t.thisShow=e},expression:"thisShow"}})},l=[],c=a("4c9f"),r=a("d048"),h=a("320d"),d=a.n(h),g=a("0a83"),u=a.n(g),m=a("4563"),p=a.n(m),f={components:{floatWindowBase:c["a"]},props:{show:{default:!1}},data(){return{thisShow:this.show,path:"",treeList:[],img:{OneDrive:d.a,folder:u.a,file:p.a},lock:{loading:!0}}},watch:{show(t){this.thisShow=t},thisShow(t){this.$emit("update:show",t),this.path="",t&&(this.lock.loading=!0,this.getRootInfo())}},computed:{...Object(o["d"])({graphAPI:t=>t.graphAPI,data_path:t=>t.data_path,language:t=>t.language,dbList:t=>t.dbList,theme:t=>t.theme}),...Object(o["b"])(["local"]),v(){return this}},methods:{...Object(o["c"])({reviseConfig:"reviseConfig"}),async addDS(){""!==this.path&&(this.data_path.push(this.path),await this.reviseConfig({v:this,data_path:this.data_path}),this.$emit("finished"),this.thisShow=!1)},async getRootInfo(){if(!this.lock.loading)return;this.lock.loading=!1;let t=await this.graphAPI.OneDrive.Drive().listAsync();if(t){let e=this.onedriveChildrenFormat(t);this.treeList=e}this.lock.loading=!0},onedriveChildrenFormat(t,e=null){let a=t;return a.forEach((t,i)=>{t.folder?(a[i].icon=this.img.folder,a[i].children=[]):a[i].icon=this.img.file,a[i].loading=!1,a[i].finished=!1,a[i].depth=e?e.depth+1:1,a[i].parent=e,a[i].path=e?e.path+"/"+a[i].name:a[i].name}),a},async expandItem(t){if(this.path=t.path,!t.folder)return;if(t.finished)return;t.loading=!0;let e=await this.graphAPI.OneDrive.Drive().item(t.id).listAsync();e&&(t.children=this.onedriveChildrenFormat(e,t)),t.finished=!0,t.loading=!1}}},v=f,w=(a("8e7a"),a("8e3e")),b=Object(w["a"])(v,n,l,!1,null,null,null),k=b.exports,x={components:{addDs:k},data(){return{cur_language:{},languages:[{key:"en",text:"English"},{key:"cn",text:"简体中文"}],thisDataIndex:-1,img:{OneDrive:d.a},show:{addDS:!1},lock:{switchDSDB:!0}}},watch:{$route(){this.languageInit()},language(){this.languageInit()}},computed:{...Object(o["d"])({graphAPI:t=>t.graphAPI,userInfo:t=>t.userInfo,init_status:t=>t.init_status,data_index:t=>t.data_index,data_path:t=>t.data_path,dbList:t=>t.dbList,language:t=>t.language,theme:t=>t.theme}),...Object(o["b"])(["local","cur_db"]),v(){return this},thisDBList(){let t=this.data_path,e=[];return t.forEach((a,i)=>{e.push({key:i,name:t[i],path:t[i],index:i,choosen:i===this.data_index,disabled:()=>500===a.status||!this.lock.switchDSDB})}),e},SourceIndexDisabled(){return t=>!this.dbList[t]||(this.data_path[t]!==this.dbList[t].key||!this.dbList[t].init)}},mounted(){this.languageInit()},methods:{...Object(o["c"])({reviseConfig:"reviseConfig",reviseDS:"reviseDS",reviseData:"reviseData",toggleTheme:"toggleTheme",syncDS:"syncDS",saveLocalStorage:"saveLocalStorage",getLocalStorage:"getLocalStorage",cleanLocalStorage:"cleanLocalStorage"}),languageInit(){this.cur_language=this.languages.find(t=>t.key===this.language)},chooseLanguage(t){this.reviseConfig({v:this,language:t.key})},switchDSDB(t){let e=this.data_path.indexOf(t.item.path);this.SourceIndexDisabled(e)||(this.lock.switchDSDB=!1,this.reviseConfig({v:this,data_index:e}),this.lock.switchDSDB=!0)},removeDS(t){this.$infoBox(this.local("Are you sure to remove this data source?"),{status:"error",title:this.local("Remove Data Source"),confirmTitle:this.local("Confirm"),cancelTitle:this.local("Cancel"),theme:this.theme,confirm:()=>{let e=t.path,a=this.data_path.indexOf(e);this.data_path.splice(a,1)},cancel:()=>{}})},login(){this.graphAPI.loginAsync(r["LoginType"].Popup).then(async t=>{let e=this.graphAPI.getAccounts();e.length>0&&this.graphAPI.setActiveAccount(e[0]),console.log(e,t)})},async logout(){}}},S=x,y=(a("9f86"),Object(w["a"])(S,i,s,!1,null,null,null));e["default"]=y.exports},"8e7a":function(t,e,a){"use strict";a("386c")},"9f86":function(t,e,a){"use strict";a("42d3")}}]);
//# sourceMappingURL=chunk-2d018f2f.6e4e3b9d.js.map